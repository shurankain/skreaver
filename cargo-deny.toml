# cargo-deny configuration for Skreaver
# Modern configuration format for security scanning

[graph]
# Skip dev-dependencies for advisory/ban checks
all-features = false
exclude-dev = true

[advisories]
# Security vulnerability database checks
db-path = "~/.cargo/advisory-db"
db-urls = ["https://github.com/rustsec/advisory-db"]

# Deny all vulnerabilities by default
version = 2
yanked = "deny"
unmaintained = "all"

# Allow specific advisories if needed (none currently)
ignore = [
    # Example: "RUSTSEC-2020-0001",
]

[licenses]
# Only allow OSI-approved, permissive licenses compatible with MIT
version = 2
confidence-threshold = 0.8

# Allowed licenses
allow = [
    "MIT",
    "Apache-2.0",
    "Apache-2.0 WITH LLVM-exception",  # LLVM tools
    "BSD-2-Clause",
    "BSD-3-Clause",
    "ISC",
    "Unicode-DFS-2016",  # Unicode data
    "Unicode-3.0",  # Unicode License v3 (ICU crates)
    "CC0-1.0",  # Public domain
    "0BSD",  # Zero-Clause BSD
    "Zlib",  # Zlib License (foldhash, zlib-rs)
]

# No specific exceptions needed currently

[bans]
# Allow multiple versions for problematic crates
multiple-versions = "allow"
wildcards = "allow"

# Skip certain crates for multiple-version checks
skip = [
    { name = "windows-sys" },  # Windows crates often have multiple versions
]

# Ban specific problematic crates (commented out to avoid issues)
deny = [
    # Known security issues would go here if needed
    # { name = "example-crate", version = "*" },
]

# Allow specific crates that might otherwise be flagged
skip-tree = [
    { name = "criterion" },  # Benchmarking tool, not shipped
]

[sources]
# Only allow crates from crates.io
unknown-registry = "deny"
unknown-git = "deny"

# Allow git sources for development/testing tools
allow-git = [
    # "https://github.com/org/repo",  # Example if needed
]

# Org/user whitelist for git sources
[sources.allow-org]
github = []
gitlab = []
bitbucket = []